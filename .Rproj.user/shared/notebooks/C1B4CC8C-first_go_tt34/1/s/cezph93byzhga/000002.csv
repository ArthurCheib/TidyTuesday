"0","thx_escope <- thanks_dataset %>% "
"0","  select(1,2, pie1:pie13, prayer, age, family_income) %>%"
"0","  filter(celebrate == ""Yes"")"
"0","thx_table <- thx_escope %>% "
"0","  select(prayer, family_income) %>%"
"0","  group_by(prayer, family_income) %>% "
"0","  summarize(TOTAL = n()) %>%"
"0","  na.omit() %>%"
"0","  spread(key = family_income, value = TOTAL) "
"0","  "
"0","thx_table[, 2:12] <- round((thx_table[, 2:12]/rowSums(thx_table[, 2:12])), digits = 3)*100"
"0","thx_table %>%"
"0","  gather(key = family_income, value = TOTAL, -prayer) %>% "
"0","  mutate(TOTAL = case_when(prayer == ""No"" ~ -TOTAL,"
"0","                           TRUE ~ TOTAL),"
"0","         family_income = factor(family_income, levels = c(""Prefer not to answer"", ""$0 to $9,999"", ""$10,000 to $24,999"","
"0","                                                          ""$25,000 to $49,999"", ""$50,000 to $74,999"", ""$75,000 to $99,999"","
"0","                                                          ""$100,000 to $124,999"", ""$125,000 to $149,999"", ""$150,000 to $174,999"","
"0","                                                          ""$175,000 to $199,999"", ""$200,000 and up""))) %>% "
"0","  ggplot(aes(x = family_income, y = TOTAL, fill = prayer)) +"
"0","  geom_col() +"
"0","  geom_label(aes(label = str_c(format(abs(TOTAL)), ""%"")), fill = ""white"") +"
"0","  coord_flip() +"
"0","  scale_y_continuous(limits = c(-20, 20), labels = abs) +"
"0","  theme_economist() +"
"0","  labs(title = ""PERCENTAGE OF RESPONDENTS THAT \n PRAYS IN THANKSGIVING DINNERS"","
"0","       subtitle = ""Displayed by family combined income"","
"0","       y = """","
"0","       x = """") +"
"0","  theme(legend.position = ""none"","
"0","        plot.title = element_text( size = 14))"
